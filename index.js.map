{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["const API_KEY = '49490613-8cd40a9bd53e95e64061d42d8';\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\naxios.defaults.params = {\n  key: API_KEY,\n};\n\nexport default async function getList(query, page, pageSize = 15) {\n  const response = await axios.get('/', {\n    params: {\n      q: query,\n      page: page,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      per_page: pageSize,\n      safesearch: true,\n    },\n  });\n  if (!response.data?.hits.length) {\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  }\n\n  return {\n    images: response.data.hits,\n    pages: Math.ceil(response.data.totalHits / pageSize),\n  };\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nfunction toggleLoader() {\n  const loader = document.querySelector('.loader');\n  loader.classList.toggle('active');\n}\n\nconst gallery = new SimpleLightbox('#gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst galleryElement = document.querySelector('#gallery');\n\nfunction getImagesHtml(images) {\n  return images\n    .map(\n      image =>\n        `<li class=\"gallery-item\">\n              <a href=\"${image.largeImageURL}\"><img class=\"gallery-img\" src=\"${image.webformatURL}\" alt=\"${image.tags}\"/></a>\n              <ul class=\"gallery-item-desc\">\n                <li>\n                  <h3>Likes</h3>\n                  <p>${image.likes}</p>\n                </li>\n                <li>\n                  <h3>Views</h3>\n                  <p>${image.views}</p>\n                </li>\n                <li>\n                  <h3>Comments</h3>\n                  <p>${image.comments}</p>\n                </li>\n                <li>\n                  <h3>Downloads</h3>\n                  <p>${image.downloads}</p>\n                </li>\n              </ul>\n        </li>`\n    )\n    .join('');\n}\n\nfunction renderSearchResults(images) {\n  galleryElement.innerHTML = getImagesHtml(images);\n\n  gallery.refresh();\n}\n\nfunction renderNewPage(images) {\n  galleryElement.insertAdjacentHTML('beforeend', getImagesHtml(images));\n  gallery.refresh();\n  const anyTile = document.querySelector('li.gallery-item');\n  const doubleHeight = anyTile.getBoundingClientRect().height * 2;\n  window.scrollBy({\n    top: doubleHeight,\n    behavior: 'smooth',\n  });\n}\n\nexport { renderSearchResults, renderNewPage, toggleLoader };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport searchImages from './js/pixabay-api.js';\nimport * as renderFunctions from './js/render-functions.js';\n\nconst form = document.getElementById('search-form');\nconst loadMoreButton = document.getElementById('load-more');\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  await search(form.elements.query.value);\n  form.reset();\n});\n\nloadMoreButton.addEventListener('click', loadMore);\n\nasync function getImagesWithLoader({ query, page = 1 }, callable) {\n  renderFunctions.toggleLoader();\n  try {\n    const result = await searchImages(query, page);\n    callable(result);\n  } catch (e) {\n    iziToast.error({ message: e.message });\n    throw e;\n  } finally {\n    renderFunctions.toggleLoader();\n  }\n}\n\nasync function search(query) {\n  return getImagesWithLoader({ query }, ({ images, pages }) => {\n    renderFunctions.renderSearchResults(images);\n    loadMoreButton.hidden = pages <= 1;\n    loadMoreButton.dataset.query = query;\n    loadMoreButton.dataset.page = String(2);\n  });\n}\n\nasync function loadMore() {\n  const { query, page } = loadMoreButton.dataset;\n  await getImagesWithLoader(\n    { query, page: Number(page) },\n    ({ images, pages }) => {\n      renderFunctions.renderNewPage(images);\n      const nextPage = Number(page) + 1;\n      loadMoreButton.dataset.page = String(nextPage);\n\n      if (nextPage > pages) {\n        loadMoreButton.hidden = true;\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    }\n  );\n}\n"],"names":["API_KEY","axios","getList","query","page","pageSize","response","_a","toggleLoader","gallery","SimpleLightbox","galleryElement","getImagesHtml","images","image","renderSearchResults","renderNewPage","doubleHeight","form","loadMoreButton","event","search","loadMore","getImagesWithLoader","callable","renderFunctions.toggleLoader","result","searchImages","e","iziToast","pages","renderFunctions.renderSearchResults","renderFunctions.renderNewPage","nextPage"],"mappings":"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"}